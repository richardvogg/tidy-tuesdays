pass_actors %>%
rbind(fail_actors) %>%
ggplot(aes(x=1,y=-i))+
geom_text(aes(label=actors,alpha=perc,col=type),family="Chango")+
scale_alpha_binned(range=c(0.5,1))+
scale_color_manual(values=c("darkred","blue"))+
labs(title="Who participates in movies which pass / fail the Bechdel test?",
subtitle=paste0("For a movie to pass the test there have to be at least two named women and they",
"\nhave to have a conversation with each other which is not about men.",
"\n\nThese lists show actors / actresses which appear in at least eight movies (1970-2013)",
"\nand almost exclusively participate in movies which pass or fail the test."),
caption="Data: FiveThirtyEight")+
#coord_cartesian(ylim=c(-22,0))+
facet_wrap(~type)+
theme_void()+
theme(legend.position = "none",
plot.title=element_text(family="Roboto",size=16),
plot.subtitle = element_text(family="Roboto",size=12),
plot.caption = element_text(family="Roboto",size=8),
plot.background = element_rect(fill = "ivory"),
strip.text.x = element_text(family = "Roboto",size=15,margin=margin(5,0,5,0)))
pass_actors %>%
rbind(fail_actors) %>%
ggplot(aes(x=1,y=-i))+
geom_text(aes(label=actors,alpha=perc,col=type),family="Chango")+
scale_alpha_binned(range=c(0.5,1))+
scale_color_manual(values=c("darkred","blue"))+
labs(title="Who participates in movies which pass / fail the Bechdel test?",
subtitle=paste0("For a movie to pass the test there have to be at least two named women and they",
"\nhave to have a conversation with each other which is not about men.",
"\n\nThese lists show actors / actresses which appear in at least eight movies (1970-2013)",
"\nand almost exclusively participate in movies which pass or fail the test."),
caption="Data: FiveThirtyEight")+
#coord_cartesian(ylim=c(-22,0))+
facet_wrap(~type)+
theme_void()+
theme(legend.position = "none",
plot.title=element_text(family="Roboto",size=16,hjust=0.5),
plot.subtitle = element_text(family="Roboto",size=12),
plot.caption = element_text(family="Roboto",size=8),
plot.background = element_rect(fill = "ivory"),
strip.text.x = element_text(family = "Roboto",size=15,margin=margin(5,0,5,0)))
pass_actors %>%
rbind(fail_actors) %>%
ggplot(aes(x=1,y=-i))+
geom_text(aes(label=actors,alpha=perc,col=type),family="Chango")+
scale_alpha_binned(range=c(0.5,1))+
scale_color_manual(values=c("darkred","blue"))+
labs(title="Who participates in movies which pass / fail the Bechdel test?",
subtitle=paste0("For a movie to pass the test there have to be at least two named women and they",
"\nhave to have a conversation with each other which is not about men.",
"\n\nThese lists show actors / actresses which appear in at least eight movies (1970-2013)",
"\nand almost exclusively participate in movies which pass or fail the test."),
caption="Data: FiveThirtyEight")+
#coord_cartesian(ylim=c(-22,0))+
facet_wrap(~type)+
theme_void()+
theme(legend.position = "none",
plot.title=element_text(family="Roboto",size=16,hjust=0.1),
plot.subtitle = element_text(family="Roboto",size=12,hjust=0.1),
plot.caption = element_text(family="Roboto",size=8,hjust=-0.1),
plot.background = element_rect(fill = "ivory"),
strip.text.x = element_text(family = "Roboto",size=15,margin=margin(5,0,5,0)))
pass_actors %>%
rbind(fail_actors) %>%
ggplot(aes(x=1,y=-i))+
geom_text(aes(label=actors,alpha=perc,col=type),family="Chango")+
scale_alpha_binned(range=c(0.5,1))+
scale_color_manual(values=c("darkred","blue"))+
labs(title="Who participates in movies which pass / fail the Bechdel test?",
subtitle=paste0("For a movie to pass the test there have to be at least two named women and they",
"\nhave to have a conversation with each other which is not about men.",
"\n\nThese lists show actors / actresses which appear in at least eight movies (1970-2013)",
"\nand almost exclusively participate in movies which pass or fail the test."),
caption="Data: FiveThirtyEight")+
#coord_cartesian(ylim=c(-22,0))+
facet_wrap(~type)+
theme_void()+
theme(legend.position = "none",
plot.title=element_text(family="Roboto",size=16,hjust=0.1),
plot.subtitle = element_text(family="Roboto",size=12,hjust=0.1),
plot.caption = element_text(family="Roboto",size=8,hjust=-0.1),
plot.background = element_rect(fill = "ivory"),
strip.text.x = element_text(family = "Roboto",size=15,margin=margin(15,0,5,0)))
pass_actors %>%
rbind(fail_actors) %>%
ggplot(aes(x=1,y=-i))+
geom_text(aes(label=actors,alpha=perc,col=type),family="Chango")+
scale_alpha_binned(range=c(0.5,1))+
scale_color_manual(values=c("darkred","blue"))+
labs(title="Who participates in movies which pass / fail the Bechdel test?",
subtitle=paste0("For a movie to pass the test there have to be at least two named women and they",
"\nhave to have a conversation with each other which is not about men.",
"\n\nThese lists show actors / actresses which appear in at least eight movies (1970-2013)",
"\nand almost exclusively participate in movies which pass or fail the test."),
caption="Data: FiveThirtyEight")+
#coord_cartesian(ylim=c(-22,0))+
facet_wrap(~type)+
theme_void()+
theme(legend.position = "none",
plot.title=element_text(family="Roboto",size=16,hjust=0.1),
plot.subtitle = element_text(family="Roboto",size=12,hjust=0.1),
plot.caption = element_text(family="Roboto",size=8,hjust=-0.1),
plot.background = element_rect(fill = "ivory"),
strip.text.x = element_text(family = "Roboto",size=15,margin=margin(10,0,5,0)))
pass_actors %>%
rbind(fail_actors) %>%
ggplot(aes(x=1,y=-i))+
geom_text(aes(label=actors,alpha=perc,col=type),family="Chango")+
scale_alpha_binned(range=c(0.5,1))+
scale_color_manual(values=c("darkred","blue"))+
labs(title="Who participates in movies which pass / fail the Bechdel test?",
subtitle=paste0("For a movie to pass the test there have to be at least two named women and they",
"\nhave to have a conversation with each other which is not about men.",
"\n\nThese lists show actors / actresses which appear in at least eight movies (1970-2013)",
"\nand almost exclusively participate in movies which pass or fail the test."),
caption="Data: FiveThirtyEight")+
#coord_cartesian(ylim=c(-22,0))+
facet_wrap(~type)+
theme_void()+
theme(legend.position = "none",
plot.title=element_text(family="Roboto",size=16,hjust=0.1),
plot.subtitle = element_text(family="Roboto",size=12,hjust=0.1),
plot.caption = element_text(family="Roboto",size=8),
plot.background = element_rect(fill = "ivory"),
strip.text.x = element_text(family = "Roboto",size=15,margin=margin(10,0,5,0)))
pass_actors %>%
rbind(fail_actors) %>%
ggplot(aes(x=1,y=-i))+
geom_text(aes(label=actors,alpha=perc,col=type),family="Chango")+
scale_alpha_binned(range=c(0.5,1))+
scale_color_manual(values=c("darkred","blue"))+
labs(title="Who participates in movies which pass / fail the Bechdel test?",
subtitle=paste0("For a movie to pass the test there have to be at least two named women and they",
"\nhave to have a conversation with each other which is not about men.",
"\n\nThese lists show actors / actresses which appear in at least eight movies (1970-2013)",
"\nand almost exclusively participate in movies which pass or fail the test."),
caption="Data: FiveThirtyEight")+
#coord_cartesian(ylim=c(-22,0))+
facet_wrap(~type)+
theme_void()+
theme(legend.position = "none",
plot.title=element_text(family="Roboto",size=16,margin=margin(0,10,0,10)),
plot.subtitle = element_text(family="Roboto",size=12,hjust=0.1),
plot.caption = element_text(family="Roboto",size=8),
plot.background = element_rect(fill = "ivory"),
strip.text.x = element_text(family = "Roboto",size=15,margin=margin(10,0,5,0)))
pass_actors %>%
rbind(fail_actors) %>%
ggplot(aes(x=1,y=-i))+
geom_text(aes(label=actors,alpha=perc,col=type),family="Chango")+
scale_alpha_binned(range=c(0.5,1))+
scale_color_manual(values=c("darkred","blue"))+
labs(title="Who participates in movies which pass / fail the Bechdel test?",
subtitle=paste0("For a movie to pass the test there have to be at least two named women and they",
"\nhave to have a conversation with each other which is not about men.",
"\n\nThese lists show actors / actresses which appear in at least eight movies (1970-2013)",
"\nand almost exclusively participate in movies which pass or fail the test."),
caption="Data: FiveThirtyEight")+
#coord_cartesian(ylim=c(-22,0))+
facet_wrap(~type)+
theme_void()+
theme(legend.position = "none",
plot.title=element_text(family="Roboto",size=16,hjust=0.1),
plot.subtitle = element_text(family="Roboto",size=12,hjust=0.1),
plot.caption = element_text(family="Roboto",size=8),
plot.background = element_rect(fill = "ivory"),
strip.text.x = element_text(family = "Roboto",size=15,margin=margin(10,0,5,0)))
pass_actors %>%
rbind(fail_actors) %>%
ggplot(aes(x=1,y=-i))+
geom_text(aes(label=actors,alpha=perc,col=type),family="Chango")+
scale_alpha_binned(range=c(0.5,1))+
scale_color_manual(values=c("darkred","blue"))+
labs(title="Who participates in movies which pass / fail the Bechdel test?",
subtitle=paste0("For a movie to pass the test there have to be at least two named women and they",
"\nhave to have a conversation with each other which is not about men.",
"\n\nThese lists show actors / actresses which appear in at least eight movies (1970-2013)",
"\nand almost exclusively participate in movies which pass or fail the test."),
caption="Data: FiveThirtyEight")+
#coord_cartesian(ylim=c(-22,0))+
facet_wrap(~type)+
theme_void()+
theme(legend.position = "none",
plot.title=element_text(family="Roboto",size=16,hjust=0.1),
plot.subtitle = element_text(family="Roboto",size=12,hjust=0.1),
plot.caption = element_text(family="Roboto",size=8),
plot.background = element_rect(fill = "ivory",col=NA),
strip.text.x = element_text(family = "Roboto",size=15,margin=margin(10,0,5,0)))
pass_actors %>%
rbind(fail_actors) %>%
ggplot(aes(x=1,y=-i))+
geom_text(aes(label=actors,alpha=perc,col=type),family="Chango")+
scale_alpha_binned(range=c(0.5,1))+
scale_color_manual(values=c("darkred","blue"))+
labs(title="Who participates in movies which pass / fail the Bechdel test?",
subtitle=paste0("For a movie to pass the test there have to be at least two named women and they",
"\nhave to have a conversation with each other which is not about men.",
"\n\nThese lists show actors / actresses which appear in at least eight movies (1970-2013)",
"\nand almost exclusively participate in movies which pass or fail the test."),
caption="Data: FiveThirtyEight")+
#coord_cartesian(ylim=c(-22,0))+
facet_wrap(~type)+
theme_void()+
theme(legend.position = "none",
plot.title=element_text(family="Roboto",size=16,hjust=0.1),
plot.subtitle = element_text(family="Roboto",size=12,hjust=0.1),
plot.caption = element_text(family="Roboto",size=8),
plot.background = element_rect(fill = "ivory",col=NULL),
strip.text.x = element_text(family = "Roboto",size=15,margin=margin(10,0,5,0)))
pass_actors %>%
rbind(fail_actors) %>%
ggplot(aes(x=1,y=-i))+
geom_text(aes(label=actors,alpha=perc,col=type),family="Chango")+
scale_alpha_binned(range=c(0.5,1))+
scale_color_manual(values=c("darkred","blue"))+
labs(title="Who participates in movies which pass / fail the Bechdel test?",
subtitle=paste0("For a movie to pass the test there have to be at least two named women and they",
"\nhave to have a conversation with each other which is not about men.",
"\n\nThese lists show actors / actresses which appear in at least eight movies (1970-2013)",
"\nand almost exclusively participate in movies which pass or fail the test."),
caption="Data: FiveThirtyEight")+
#coord_cartesian(ylim=c(-22,0))+
facet_wrap(~type)+
theme_void()+
theme(legend.position = "none",
plot.title=element_text(family="Roboto",size=16,hjust=0.1),
plot.subtitle = element_text(family="Roboto",size=12,hjust=0.1),
plot.caption = element_text(family="Roboto",size=8),
plot.background = element_rect(fill = "ivory",col="ivory"),
strip.text.x = element_text(family = "Roboto",size=15,margin=margin(10,0,5,0)))
pass_actors %>%
rbind(fail_actors) %>%
ggplot(aes(x=1,y=-i))+
geom_text(aes(label=actors,alpha=perc,col=type),family="Chango")+
scale_alpha_binned(range=c(0.5,1))+
scale_color_manual(values=c("darkred","blue"))+
labs(title="Who participates in movies which pass / fail the Bechdel test?",
subtitle=paste0("For a movie to pass the test there have to be at least two named women and they",
"\nhave to have a conversation with each other which is not about men.",
"\n\nThese lists show actors / actresses which appear in at least eight movies (1970-2013)",
"\nand almost exclusively participate in movies which pass or fail the test."),
caption="Data: FiveThirtyEight")+
#coord_cartesian(ylim=c(-22,0))+
facet_wrap(~type)+
theme_void()+
theme(legend.position = "none",
plot.title=element_text(family="Roboto",size=16,hjust=0.1),
plot.subtitle = element_text(family="Roboto",size=12,hjust=0.1),
plot.caption = element_text(family="Roboto",size=8),
plot.background = element_rect(fill = "ivory",colour=NA),
strip.text.x = element_text(family = "Roboto",size=15,margin=margin(10,0,5,0)))
pass_actors %>%
rbind(fail_actors) %>%
ggplot(aes(x=1,y=-i))+
geom_text(aes(label=actors,alpha=perc,col=type),family="Chango")+
scale_alpha_binned(range=c(0.5,1))+
scale_color_manual(values=c("darkred","blue"))+
labs(title="Who participates in movies which pass / fail the Bechdel test?",
subtitle=paste0("For a movie to pass the test there have to be at least two named women and they",
"\nhave to have a conversation with each other which is not about men.",
"\n\nThese lists show actors / actresses which appear in at least eight movies (1970-2013)",
"\nand almost exclusively participate in movies which pass or fail the test."),
caption="Data: FiveThirtyEight")+
#coord_cartesian(ylim=c(-22,0))+
facet_wrap(~type)+
theme_void()+
theme(legend.position = "none",
plot.title=element_text(family="Roboto",size=16,hjust=0.1),
plot.subtitle = element_text(family="Roboto",size=12,hjust=0.1,margin=margin(10,0,10,0)),
plot.caption = element_text(family="Roboto",size=8),
plot.background = element_rect(fill = "ivory",colour=NA),
strip.text.x = element_text(family = "Roboto",size=15,margin=margin(10,0,5,0)))
library(dplyr)
library(ggplot2)
library(ggraph)
library(igraph)
library(stringr)
tuesdata <- tidytuesdayR::tt_load(2021, week = 9)
employed <- tuesdata$employed
earn <- tuesdata$earn
employed <- employed %>%
filter(!is.na(industry)) %>%
filter(race_gender=="TOTAL") %>%
filter(year==2020) %>%
filter(employ_n != 0 & !is.na(employ_n))
edges <- employed %>%
distinct(from = ".", to = industry) %>%
rbind(employed %>%
distinct(from=industry,to=paste0(industry,".",major_occupation))) %>%
rbind(employed %>%
distinct(from=paste0(industry,".",major_occupation),
to=paste0(industry,".",major_occupation,".",minor_occupation)))
# Usually we associate another dataset that give information about each node of the dataset:
vertices <- employed %>%
mutate(level=4,short_name=minor_occupation) %>%
distinct(name=paste0(industry,".",major_occupation,".",minor_occupation),
size=employ_n, level, short_name) %>%
select(name,size,level,short_name) %>%
rbind(employed %>%
mutate(size=0,level=3,short_name=paste0(major_occupation)) %>%
distinct(name=paste0(industry,".",major_occupation), size, level,short_name)) %>%
rbind(employed %>% distinct(name=industry) %>% mutate(size=0,level=2,short_name=name)) %>%
rbind(data.frame(name=".",size=0,level=1,short_name=".")) %>%
mutate(new_label = ifelse(level==2,name,NA),
new_fill = ifelse(level==4,short_name,NA),
new_col = ifelse(level==3,short_name,NA))
# Then we have to make a 'graph' object using the igraph library:
mygraph <- graph_from_data_frame( edges, vertices=vertices )
levels3list <- unique(vertices$new_fill[vertices$level==3])
levels4list <- unique(vertices$new_fill[vertices$level==4]) %>%
str_wrap(20)
colors <- c("darkred","darksalmon","blue","aquamarine1","orange",
"goldenrod","darkgreen","lightgreen","olivedrab1","grey80","grey40")
names(colors) <- levels4list
set.seed(62)
ggraph(mygraph, layout = 'circlepack',weight=size) +
geom_node_circle(aes(fill = str_wrap(new_fill,20),col=new_col),size=2) +
geom_node_text(aes(label=str_wrap(new_label,15))) +
scale_fill_manual(values=colors,breaks=levels4list,na.translate=FALSE) +
scale_colour_manual(values=c("red","green","grey60","yellow","lightblue"),
breaks=levels3list,na.translate=FALSE) +
labs(fill="Sub-category")+
guides(fill=guide_legend(ncol = 5))+
theme_void()+
theme(legend.position = c(0.5,0.1))
library(dplyr)
library(ggplot2)
tuesdata <- tidytuesdayR::tt_load(2021, week = 13)
unvotes <- tuesdata$unvotes
roll_calls <- tuesdata$roll_calls
issues <- tuesdata$issues
View(unvotes)
rm(tuesdata)
View(roll_calls)
View(issues)
View(roll_calls)
issues %>%
count(issue,sort=TRUE)
world <- ne_countries(scale = "small", returnclass = 'sf')
library(rnaturalearth)
world <- ne_countries(scale = "small", returnclass = 'sf')
View(world)
View(unvotes)
View(roll_calls)
View(roll_calls)
View(unvotes)
unvotes %>%
filter(rcid==4820)
View(world)
world <- ne_countries(scale = "small", returnclass = 'sf') %>%
select(iso_a2,geometry)
View(world)
world <- ne_countries(scale = "small", returnclass = 'sf') %>%
select(name,iso_a2,geometry)
View(world)
View(unvotes)
world <- ne_countries(scale = "small", returnclass = 'sf')
View(world)
world <- ne_countries(scale = "small", returnclass = 'sf') %>%
select(name,iso_a2,geometry) %>%
mutate(iso_a2=ifelse(name=="Norway","NO",iso_a2))
View(world)
)
world <- ne_countries(scale = "small", returnclass = 'sf') %>%
select(name,iso_a2,geometry) %>%
mutate(iso_a2=case_when(
name=="Norway" ~ "NO",
name=="France" ~ "FR",
TRUE ~ iso_a2
)
)
View(world)
unvotes
unvotes %>%
filter(rcid==4820) %>%
left_join(world,by=c("country_code"="iso_a2")) %>% View()
unvotes %>%
filter(rcid==4820) %>%
left_join(world,by=c("country_code"="iso_a2")) %>% View()
unvotes %>%
filter(rcid==4820) %>%
left_join(world,by=c("country_code"="iso_a2")) %>% View()
library(sf)
unvotes %>%
filter(rcid==4820) %>%
left_join(world,by=c("country_code"="iso_a2")) %>%
ggplot()+geom_sf(aes(fill=vote))
votes <- unvotes %>%
filter(rcid==4820)
world %>%
right_join(votes,by=c("iso_a2"="country_code")) %>%
ggplot()+geom_sf(aes(fill=vote))
world %>%
right_join(votes,by=c("iso_a2"="country_code")) %>%
ggplot()+geom_sf(aes(fill=vote),col="black")
world %>%
outer_join(votes,by=c("iso_a2"="country_code")) %>%
ggplot()+geom_sf(aes(fill=vote),col="black")
world %>%
full_join(votes,by=c("iso_a2"="country_code")) %>%
ggplot()+geom_sf(aes(fill=vote),col="black")
View(roll_calls)
votes <- unvotes %>%
filter(rcid==9060)
world %>%
full_join(votes,by=c("iso_a2"="country_code")) %>%
ggplot()+geom_sf(aes(fill=vote),col="black")
votes <- unvotes %>%
filter(rcid==9071)
world %>%
full_join(votes,by=c("iso_a2"="country_code")) %>%
ggplot()+geom_sf(aes(fill=vote),col="black")
View(roll_calls)
str(roll_calls)
world <- ne_countries(scale = "small", returnclass = 'sf') %>%
filter(brk_name!="Antarctica") %>%
select(name,iso_a2,geometry) %>%
mutate(iso_a2=case_when(
name=="Norway" ~ "NO",
name=="France" ~ "FR",
TRUE ~ iso_a2
)
)
roll_calls
votes <- roll_calls %>%
filter(date>2010-01-01)
View(votes)
votes <- roll_calls %>%
filter(date>as.Date("2010-01-01"))
View(votes)
View(roll_calls)
View(votes)
votes %>%
count(importantvote)
View(issues)
View(issues)
votes %>%
left_join(issues,by="rcid")
votes %>%
left_join(issues,by="rcid") %>%
count(issue)
unvotes %>%
filter(rcid %in% votes$rcid)
unvotes_decade <- unvotes %>%
filter(rcid %in% votes$rcid)
unvotes_decade <- unvotes %>%
left_join(issues,by="rcid")
unvotes_decade <- unvotes %>%
filter(rcid %in% votes$rcid) %>%
left_join(issues,by="rcid")
View(unvotes)
View(issues)
unvotes %>%
filter(rcid %in% votes$rcid)
View(issues)
unvotes_decade <- unvotes %>%
filter(rcid %in% votes$rcid) %>% View()
unvotes %>%
filter(rcid %in% votes$rcid) %>%
left_join(issues,by="rcid")
unvotes_decade <- unvotes %>%
filter(rcid %in% votes$rcid) %>%
left_join(issues,by="rcid") %>%
group_by(country,country_code,issue) %>%
summarise(perc_yes = sum(vote=="yes")/n(),
perc_no = sum(vote=="no")/n())
View(unvotes_decade)
unvotes_decade <- unvotes %>%
filter(rcid %in% votes$rcid) %>%
left_join(issues,by="rcid") %>%
group_by(country,country_code,issue) %>%
summarise(perc_yes = sum(vote=="yes")/n(),
perc_no = sum(vote=="no")/n()) %>%
filter(!is.na(issue))
View(unvotes_decade)
world %>%
full_join(unvotes_decade,by=c("iso_a2"="country_code"))
world %>%
full_join(unvotes_decade,by=c("iso_a2"="country_code")) %>%
ggplot()+
geom_sf(aes(fill=perc_yes))+
facet_wrap(~issue)
world %>%
full_join(unvotes_decade,by=c("iso_a2"="country_code"))
world %>%
full_join(unvotes_decade,by=c("iso_a2"="country_code")) %>%
ggplot()+
geom_sf(aes(fill=perc_yes))+
facet_wrap(~issue,drop = TRUE)
world %>%
full_join(unvotes_decade,by=c("iso_a2"="country_code")) %>% View()
unvotes_decade <- unvotes %>%
filter(rcid %in% votes$rcid) %>%
left_join(issues,by="rcid") %>%
group_by(country,country_code,issue) %>%
summarise(perc_yes = sum(vote=="yes")/n(),
perc_no = sum(vote=="no")/n()) %>%
filter(!is.na(issue),!is.na(perc_yes))
world %>%
full_join(unvotes_decade,by=c("iso_a2"="country_code")) %>% View()
world %>%
full_join(unvotes_decade,by=c("iso_a2"="country_code")) %>%
ggplot()+
geom_sf(aes(fill=perc_yes))+
facet_wrap(~issue)
View(unvotes_decade)
world %>%
right_join(unvotes_decade,by=c("iso_a2"="country_code")) %>%
ggplot()+
geom_sf(aes(fill=perc_yes))+
facet_wrap(~issue)
