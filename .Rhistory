)&
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
strip.text = element_text(family = "sans", size = 14),
axis.title = element_text(family = "sans" ,size=14,colour=textcol),
axis.text = element_text(family = "sans" ,size=14,colour=textcol),
plot.title = element_text(family = "sans", face = "bold", size = 16, colour = textcol),
plot.subtitle = element_text(family = "sans" ,size=14, colour = textcol))
dev.off()
png(here::here("Week 37 - Friends/example.png"),width = 800,height=300)
audi + wow +
plot_annotation(
title="Definition and Example",
subtitle="A typical word for a character is a word that is used by this character more than double as often as by any other character."
)&
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
strip.text = element_text(family = "sans", size = 14),
axis.title = element_text(family = "sans" ,size=14,colour=textcol),
axis.text = element_text(family = "sans" ,size=14,colour=textcol),
plot.title = element_text(family = "sans", face = "bold", size = 16, colour = textcol),
plot.subtitle = element_text(family = "sans" ,size=14, colour = textcol))
dev.off()
png(here::here("Week 37 - Friends/typical_words.png"),width = 800,height=500)
clouds
dev.off()
install.packages("ggtext")
install.packages("ggtext")
friends_df <- tuesdata$friends
#Stopwords and digits
stopwords_df <- rbind(stop_words,data.frame(word=as.character(1:9),lexicon="other"))
#Find the main characters' names
main_chars <- friends_df %>%
count(speaker,sort=T) %>%
slice(1:6) %>%
.$speaker
#Count frequency of words
word_df <- friends_df %>%
filter(speaker %in% main_chars) %>%
unnest_tokens(word,text) %>%
anti_join(stopwords_df,by="word") %>%
count(speaker,word,sort=T)
#Rank the words by who uses them most
ranked_words <- word_df %>%
filter(n>1) %>%
group_by(word) %>%
mutate(rank=rank(-n,ties.method = "first"))
clouds <- cloud_words %>%
ggplot()+
geom_text_wordcloud(aes(label=word,size=sqrt(n_1),col=type))+
scale_size_area(max_size=9)+
guides(size=FALSE)+
facet_wrap(~speaker_1)+
labs(title="Typical words (not most frequent words!)",
subtitle="<span style='font-size:14pt'>Colored by
<span style='color:goldenrod;'>job related</span>,
<span style='color:chartreuse4;'>person related</span>, and
<span style='color:darkorchid1;'>others </span>
</span>")+
scale_color_manual(values=c("goldenrod","darkorchid1","chartreuse4"))+
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text=element_text(family="Lato Light",size=14,colour=textcol),
plot.title = element_text(family = "sans", face = "bold", size = 16, colour = textcol),
plot.subtitle = element_markdown(lineheight = 1.1))
clouds
install.packages("showtext")
install.packages("extrafont")
sysfonts::font_add_google(name = "Roboto Slab",family = "Roboto")
clouds <- cloud_words %>%
ggplot()+
geom_text_wordcloud(aes(label=word,size=sqrt(n_1),col=type))+
scale_size_area(max_size=9)+
guides(size=FALSE)+
facet_wrap(~speaker_1)+
labs(title="Typical words (not most frequent words!)",
subtitle="<span style='font-size:14pt'>Colored by
<span style='color:goldenrod;'>job related</span>,
<span style='color:chartreuse4;'>person related</span>, and
<span style='color:darkorchid1;'>others </span>
</span>")+
scale_color_manual(values=c("goldenrod","darkorchid1","chartreuse4"))+
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text=element_text(family="Roboto",size=14,colour=textcol),
plot.title = element_text(family = "sans", face = "bold", size = 16, colour = textcol),
plot.subtitle = element_markdown(lineheight = 1.1))
clouds
sysfonts::font_add_google(name = "Roboto Slab")
warnings()
showtext::showtext_auto()
sysfonts::font_add_google(name = "Roboto Slab","Roboto")
clouds <- cloud_words %>%
ggplot()+
geom_text_wordcloud(aes(label=word,size=sqrt(n_1),col=type))+
scale_size_area(max_size=9)+
guides(size=FALSE)+
facet_wrap(~speaker_1)+
labs(title="Typical words (not most frequent words!)",
subtitle="<span style='font-size:14pt'>Colored by
<span style='color:goldenrod;'>job related</span>,
<span style='color:chartreuse4;'>person related</span>, and
<span style='color:darkorchid1;'>others </span>
</span>")+
scale_color_manual(values=c("goldenrod","darkorchid1","chartreuse4"))+
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text=element_text(family="Roboto",size=14,colour=textcol),
plot.title = element_text(family = "sans", face = "bold", size = 16, colour = textcol),
plot.subtitle = element_markdown(lineheight = 1.1))
clouds
clouds <- cloud_words %>%
ggplot()+
geom_text_wordcloud(aes(label=word,size=sqrt(n_1),col=type),family="Roboto")+
scale_size_area(max_size=9)+
guides(size=FALSE)+
facet_wrap(~speaker_1)+
labs(title="Typical words (not most frequent words!)",
subtitle="<span style='font-size:14pt'>Colored by
<span style='color:goldenrod;'>job related</span>,
<span style='color:chartreuse4;'>person related</span>, and
<span style='color:darkorchid1;'>others </span>
</span>")+
scale_color_manual(values=c("goldenrod","darkorchid1","chartreuse4"))+
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text=element_text(family="Roboto",size=14,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol),
plot.subtitle = element_markdown(lineheight = 1.1))
clouds
png(here::here("Week 37 - Friends/typical_words.png"),width = 800,height=500)
clouds
dev.off()
audition <- ranked_words %>%
filter(word=="audition") %>%
ggplot(aes(x=n,y=speaker))+
geom_col()+
geom_vline(xintercept = 25,col="red")+
labs(x="Appearances of the word audition",y="",title="Audition - a Joey word")
wow <- ranked_words %>%
filter(word=="wow") %>%
ggplot(aes(x=n,y=speaker))+
geom_col()+
geom_vline(xintercept=83,col="red")+
labs(x="Appearances of the word wow",y="",title="Wow - not (only) a Rachel word")
audi + wow +
plot_annotation(
title="Definition and Example",
subtitle="A typical word for a character is a word that is used by this character more than double as often as by any other character."
)&
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text = element_text(family="Roboto",size=14,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol))
audition <- ranked_words %>%
filter(word=="audition") %>%
ggplot(aes(x=n,y=speaker))+
geom_col()+
geom_vline(xintercept = 25,col="red")+
labs(x="Appearances of the word audition",y="",title="Audition - a Joey word")
audi + wow +
plot_annotation(
title="Definition and Example",
subtitle="A typical word for a character is a word that is used by this character more than double as often as by any other character."
)&
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text = element_text(family="Roboto",size=12,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol))
audition + wow +
plot_annotation(
title="Definition and Example",
subtitle="A typical word for a character is a word that is used by this character more than double as often as by any other character."
)&
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text = element_text(family="Roboto",size=12,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol))
png(here::here("Week 37 - Friends/example.png"),width = 800,height=300)
audition + wow +
plot_annotation(
title="Definition and Example",
subtitle="A typical word for a character is a word that is used by this character more than double as often as by any other character."
)&
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text = element_text(family="Roboto",size=12,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol))
dev.off()
png(here::here("Week 37 - Friends/example.png"),width = 800,height=300)
audition + wow +
plot_annotation(
title="Definition and Example",
subtitle="A typical word for a character is a word that is used by this character more than double as often as by any other character."
)&
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text = element_text(family="Roboto",size=12,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol))
dev.off()
png(here::here("Week 37 - Friends/typical_words.png"),width = 1000,height=500)
clouds
dev.off()
png(here::here("Week 37 - Friends/example.png"),width = 1000,height=400)
audition + wow +
plot_annotation(
title="Definition and Example",
subtitle="A typical word for a character is a word that is used by this character more than double as often as by any other character."
)&
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text = element_text(family="Roboto",size=12,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol))
dev.off()
png(here::here("Week 37 - Friends/typical_words.png"),width = 1000,height=500)
clouds
dev.off()
warnings()
clouds
clouds <- cloud_words %>%
ggplot()+
geom_text_wordcloud(aes(label=word,size=sqrt(n_1),col=type),family="Roboto")+
scale_size_area(max_size=9)+
guides(size=FALSE)+
facet_wrap(~speaker_1)+
labs(title="Typical words (not most frequent words!)",
subtitle="<span style='font-size:14pt'>Colored by
<span style='color:goldenrod;'>job related </span>,
<span style='color:chartreuse4;'>person related </span>, and
<span style='color:darkorchid1;'>others </span>
</span>")+
scale_color_manual(values=c("goldenrod","darkorchid1","chartreuse4"))+
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text=element_text(family="Roboto",size=14,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol),
plot.subtitle = element_markdown(lineheight = 1.1))
clouds
png(here::here("Week 37 - Friends/typical_words.png"),width = 1100,height=500)
clouds
dev.off()
audition <- ranked_words %>%
filter(word=="audition") %>%
ggplot(aes(x=n,y=speaker))+
geom_col()+
geom_vline(xintercept = 25,col="red")+
labs(x="Appearances of the word audition",y="",title="Audition - a Joey word")
wow <- ranked_words %>%
filter(word=="wow") %>%
ggplot(aes(x=n,y=speaker))+
geom_col()+
geom_vline(xintercept=83,col="red")+
labs(x="Appearances of the word wow",y="",title="Wow - not (only) a Rachel word")
audition + wow +
plot_annotation(
title="Definition and Example",
subtitle="A typical word for a character is a word that is used by this character more than double as often as by any other character."
)&
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text = element_text(family="Roboto",size=12,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol))
png(here::here("Week 37 - Friends/example.png"),width = 1000,height=400)
audition + wow +
plot_annotation(
title="Definition and Example",
subtitle="A typical word for a character is a word that is used by this character more than double as often as by any other character."
)&
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text = element_text(family="Roboto",size=12,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol))
dev.off()
png(here::here("Week 37 - Friends/example.png"),width = 1000,height=400)
audition + wow +
plot_annotation(
title="Definition and Example",
subtitle="A typical word for a character is a word that is used by this character more than double as often as by any other character."
)&
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text = element_text(family="Roboto",size=12,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol))
dev.off()
png(here::here("Week 37 - Friends/typical_words.png"),width = 1100,height=500)
clouds
dev.off()
clouds <- cloud_words %>%
ggplot()+
geom_text_wordcloud(aes(label=word,size=sqrt(n_1),col=type))+
scale_size_area(max_size=9)+
guides(size=FALSE)+
facet_wrap(~speaker_1)+
labs(title="Typical words (not most frequent words!)",
subtitle="<span style='font-size:14pt'>Colored by
<span style='color:goldenrod;'>job related </span>,
<span style='color:chartreuse4;'>person related </span>, and
<span style='color:darkorchid1;'>others </span>
</span>")+
scale_color_manual(values=c("goldenrod","darkorchid1","chartreuse4"))+
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text=element_text(family="Roboto",size=14,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol),
plot.subtitle = element_markdown(lineheight = 1.1))
png(here::here("Week 37 - Friends/typical_words.png"),width = 1100,height=500)
clouds
dev.off()
clouds <- cloud_words %>%
ggplot()+
geom_text_wordcloud(aes(label=word,size=sqrt(n_1),col=type))+
scale_size_area(max_size=9)+
guides(size=FALSE)+
facet_wrap(~speaker_1)+
labs(title="Typical words (not most frequent words!)",
subtitle="<span style='font-size:14pt'>Colored by
<span style='color:goldenrod;'>job related </span>,
<span style='color:chartreuse4;'>person related </span>, and
<span style='color:darkorchid1;'>others </span>
</span>")+
scale_color_manual(values=c("goldenrod","darkorchid1","chartreuse4"))+
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text=element_text(family="Roboto",size=14,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol),
plot.subtitle = element_markdown(lineheight = 1.1))+
ggsave(here::here("Week 37 - Friends/typical_words.png"),
width = 1100, height = 500)
clouds <- cloud_words %>%
ggplot()+
geom_text_wordcloud(aes(label=word,size=sqrt(n_1),col=type))+
scale_size_area(max_size=9)+
guides(size=FALSE)+
facet_wrap(~speaker_1)+
labs(title="Typical words (not most frequent words!)",
subtitle="<span style='font-size:14pt'>Colored by
<span style='color:goldenrod;'>job related </span>,
<span style='color:chartreuse4;'>person related </span>, and
<span style='color:darkorchid1;'>others </span>
</span>")+
scale_color_manual(values=c("goldenrod","darkorchid1","chartreuse4"))+
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text=element_text(family="Roboto",size=14,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol),
plot.subtitle = element_markdown(lineheight = 1.1))+
ggsave(here::here("Week 37 - Friends/typical_words.png"),
width = 11, height = 5)
clouds <- cloud_words %>%
ggplot()+
geom_text_wordcloud(aes(label=word,size=sqrt(n_1),col=type))+
scale_size_area(max_size=9)+
guides(size=FALSE)+
facet_wrap(~speaker_1)+
labs(title="Typical words (not most frequent words!)",
subtitle="<span style='font-size:14pt'>Colored by
<span style='color:goldenrod;'>job related </span>,
<span style='color:chartreuse4;'>person related </span>, and
<span style='color:darkorchid1;'>others </span>
</span>")+
scale_color_manual(values=c("goldenrod","darkorchid1","chartreuse4"))+
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text=element_text(family="Roboto",size=14,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol),
plot.subtitle = element_markdown(lineheight = 1.1))+
ggsave(here::here("Week 37 - Friends/typical_words.png"),
width = 11, height = 5,dpi=300)
clouds <- cloud_words %>%
ggplot()+
geom_text_wordcloud(aes(label=word,size=sqrt(n_1),col=type))+
scale_size_area(max_size=9)+
guides(size=FALSE)+
facet_wrap(~speaker_1)+
labs(title="Typical words (not most frequent words!)",
subtitle="<span style='font-size:14pt'>Colored by
<span style='color:goldenrod;'>job related </span>,
<span style='color:chartreuse4;'>person related </span>, and
<span style='color:darkorchid1;'>others </span>
</span>")+
scale_color_manual(values=c("goldenrod","darkorchid1","chartreuse4"))+
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text=element_text(family="Roboto",size=14,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol),
plot.subtitle = element_markdown(lineheight = 1.1))+
ggsave(here::here("Week 37 - Friends/typical_words.png"),
width = 11, height = 5,dpi=150)
clouds <- cloud_words %>%
ggplot()+
geom_text_wordcloud(aes(label=word,size=sqrt(n_1),col=type))+
scale_size_area(max_size=9)+
guides(size=FALSE)+
facet_wrap(~speaker_1)+
labs(title="Typical words (not most frequent words!)",
subtitle="<span style='font-size:14pt'>Colored by
<span style='color:goldenrod;'>job related </span>,
<span style='color:chartreuse4;'>person related </span>, and
<span style='color:darkorchid1;'>others </span>
</span>")+
scale_color_manual(values=c("goldenrod","darkorchid1","chartreuse4"))+
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text=element_text(family="Roboto",size=14,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol),
plot.subtitle = element_markdown(lineheight = 1.1))+
ggsave(here::here("Week 37 - Friends/typical_words.png"),
width = 11, height = 5,dpi=200)
clouds
clouds <- cloud_words %>%
ggplot()+
geom_text_wordcloud(aes(label=word,size=sqrt(n_1),col=type))+
scale_size_area(max_size=9)+
guides(size=FALSE)+
facet_wrap(~speaker_1)+
labs(title="Typical words (not most frequent words!)",
subtitle="<span style='font-size:14pt'>Colored by
<span style='color:goldenrod;'>job related </span>,
<span style='color:chartreuse4;'>person related </span>, and
<span style='color:darkorchid1;'>others </span>
</span>")+
scale_color_manual(values=c("goldenrod","darkorchid1","chartreuse4"))+
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text=element_text(family="Roboto",size=14,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol),
plot.subtitle = element_markdown(lineheight = 1.1))
clouds
clouds <- cloud_words %>%
ggplot()+
geom_text_wordcloud(aes(label=word,size=sqrt(n_1),col=type),family="Roboto")+
scale_size_area(max_size=9)+
guides(size=FALSE)+
facet_wrap(~speaker_1)+
labs(title="Typical words (not most frequent words!)",
subtitle="<span style='font-size:14pt'>Colored by
<span style='color:goldenrod;'>job related </span>,
<span style='color:chartreuse4;'>person related </span>, and
<span style='color:darkorchid1;'>others </span>
</span>")+
scale_color_manual(values=c("goldenrod","darkorchid1","chartreuse4"))+
theme(plot.background = element_rect(fill = "ivory"),
panel.background = element_rect(fill="ivory2"),
text=element_text(family="Roboto",size=14,colour=textcol),
plot.title = element_text(family = "Roboto", face = "bold", size = 16, colour = textcol),
plot.subtitle = element_markdown(lineheight = 1.1))
clouds
sysfonts::font_add(family = "friends", regular = "GABRWFFR.TTF")
library(tidyverse)
library(tidytext)
library(ggtext)
library(ggwordcloud)
library(patchwork)
sysfonts::font_add_google(name = "Roboto Slab","Roboto")
showtext::showtext_auto()
tuesdata <- tidytuesdayR::tt_load(2020, week = 37)
friends_df <- tuesdata$friends
#Stopwords and digits
stopwords_df <- rbind(stop_words,data.frame(word=as.character(1:9),lexicon="other"))
#Find the main characters' names
main_chars <- friends_df %>%
count(speaker,sort=T) %>%
slice(1:6) %>%
.$speaker
#Count frequency of words
word_df <- friends_df %>%
filter(speaker %in% main_chars) %>%
unnest_tokens(word,text) %>%
anti_join(stopwords_df,by="word") %>%
count(speaker,word,sort=T)
#Check tf-idf
word_df %>%
bind_tf_idf(word,speaker,n) %>% View()
#Check tf-idf
word_df %>%
bind_tf_idf(word,speaker,n) %>%
arrange(desc(tf_idf)) %>% View()
#Check tf-idf
word_df %>%
bind_tf_idf(word,speaker,n) %>%
group_by(speaker) %>%
top_n(15) %>%
ungroup() %>%
ggplot(aes(word, tf_idf, fill = speaker)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "tf-idf") +
facet_wrap(~speaker, ncol = 2, scales = "free") +
coord_flip()
#Check tf-idf
word_df %>%
bind_tf_idf(word,speaker,n) %>%
group_by(speaker) %>%
filter(n>14) %>%
top_n(15) %>%
ungroup() %>%
ggplot(aes(word, tf_idf, fill = speaker)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "tf-idf") +
facet_wrap(~speaker, ncol = 2, scales = "free") +
coord_flip()
#Check tf-idf
word_df %>%
filter(n>14) %>%
bind_tf_idf(word,speaker,n) %>%
group_by(speaker) %>%
top_n(15) %>%
ungroup() %>%
ggplot(aes(word, tf_idf, fill = speaker)) +
geom_col(show.legend = FALSE) +
labs(x = NULL, y = "tf-idf") +
facet_wrap(~speaker, ncol = 2, scales = "free") +
coord_flip()
