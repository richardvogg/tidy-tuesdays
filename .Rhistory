scale_color_gradient(low="darkblue",high="darkorange")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="darkblue")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="darkorange")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="darkblue",high="darkorange")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0.1,y=0.9,label="Increasing inequality in the U.S."),size=15)+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="darkblue")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="darkorange")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="darkblue",high="darkorange")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0.1,y=0.9,label="Increasing inequality in the U.S."),size=10)+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="darkblue")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="darkorange")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="darkblue",high="darkorange")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0.1,y=0.9,label="Increasing inequalities"),size=10)+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="darkblue")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="darkorange")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="darkblue",high="darkorange")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0.1,y=0.9,label="Increasing inequalities"),size=10,position = "l")+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="darkblue")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="darkorange")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="darkblue",high="darkorange")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0.1,y=0.9,label="Increasing inequalities"),size=10,hjust=0)+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="darkblue")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="darkorange")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="darkblue",high="darkorange")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0,y=0.9,label="Increasing inequalities"),size=10,hjust=0)+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="darkblue")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="darkorange")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0,y=0.9,label="Increasing inequalities"),size=10,hjust=0)+
geom_text(aes(x=0,y=0.7,label=paste0("The Lorenz curve shows how much ")))
View(df)
(14.99+32.47)/2
(11.40+25.46)/2
df <- income_mean %>%
filter(dollar_type == "2019 Dollars",
year %% 10 == 9,
race %in% c("All Races")) %>%
tidyr::pivot_wider(id_cols = -c(income_quintile,income_dollars),
names_from=income_quintile,
values_from=income_dollars) %>%
mutate(Zero = 0,.before=Lowest) %>%
tidyr::pivot_longer(cols=Zero:Highest,
names_to="income_quintile",
values_to="income_dollars") %>%
mutate(pop_quintile = case_when(
income_quintile == "Zero" ~ 0,
income_quintile == "Lowest" ~ 0.2,
income_quintile == "Second" ~ 0.4,
income_quintile == "Middle" ~ 0.6,
income_quintile == "Fourth" ~ 0.8,
TRUE ~ 1
)) %>%
group_by(year,race) %>%
mutate(income_cumsum=cumsum(income_dollars),
income_prop = income_cumsum/max(income_cumsum))
View(df)
df <- income_mean %>%
filter(dollar_type == "2019 Dollars",
year %% 10 == 9,
race %in% c("All Races")) %>%
tidyr::pivot_wider(id_cols = -c(income_quintile,income_dollars),
names_from=income_quintile,
values_from=income_dollars) %>%
mutate(Zero = 0,.before=Lowest) %>%
tidyr::pivot_longer(cols=Zero:`Top 5%`,
names_to="income_quintile",
values_to="income_dollars") %>%
mutate(pop_quintile = case_when(
income_quintile == "Zero" ~ 0,
income_quintile == "Lowest" ~ 0.2,
income_quintile == "Second" ~ 0.4,
income_quintile == "Middle" ~ 0.6,
income_quintile == "Fourth" ~ 0.8,
TRUE ~ 1
)) %>%
group_by(year,race) %>%
mutate(income_cumsum=cumsum(income_dollars),
income_prop = income_cumsum/max(income_cumsum))
View(df)
df <- income_mean %>%
filter(income_quintile != "Top 5%",
dollar_type == "2019 Dollars",
year %% 10 == 9,
race %in% c("All Races")) %>%
tidyr::pivot_wider(id_cols = -c(income_quintile,income_dollars),
names_from=income_quintile,
values_from=income_dollars) %>%
mutate(Zero = 0,.before=Lowest) %>%
tidyr::pivot_longer(cols=Zero:Highest,
names_to="income_quintile",
values_to="income_dollars") %>%
mutate(pop_quintile = case_when(
income_quintile == "Zero" ~ 0,
income_quintile == "Lowest" ~ 0.2,
income_quintile == "Second" ~ 0.4,
income_quintile == "Middle" ~ 0.6,
income_quintile == "Fourth" ~ 0.8,
TRUE ~ 1
)) %>%
group_by(year,race) %>%
mutate(income_cumsum=cumsum(income_dollars),
income_prop = income_cumsum/max(income_cumsum))
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0,y=0.9,label="Increasing inequalities"),size=10,hjust=0)+
geom_text(aes(x=0,y=0.7,label=paste0("The Lorenz curve shows how much the distribution of income deviates \n",
"from a equal distribution (diagonal black line). While in 1969 \n",
"the poorest quintile of the U.S. accounted for 24% of the income, \n",
"until 2019 the value decreased to 18%. In the meantime the ")),hjust=0)
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0,y=0.9,label="Increasing inequalities"),size=10,hjust=0)+
geom_text(aes(x=0,y=0.7,label=paste0("The Lorenz curve shows how much the distribution of income deviates \n",
"from a equal distribution (diagonal black line). While in 1969 \n",
"the poorest quintile of the U.S. accounted for 24% of the income, \n",
"until 2019 the value decreased to 18%. In the meantime the ")),hjust=0)+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0,y=1,label="Increasing inequalities"),size=10,hjust=0)+
geom_text(aes(x=0,y=0.8,label=paste0("The Lorenz curve shows how much the distribution of income deviates \n",
"from a equal distribution (diagonal black line). While in 1969 \n",
"the poorest quintile of the U.S. accounted for 24% of the income, \n",
"until 2019 the value decreased to 18%. In the meantime the ")),hjust=0)+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0,y=1,label="Increasing inequalities"),size=10,hjust=0)+
geom_text(aes(x=0,y=0.8,label=paste0("The Lorenz curve shows how much the distribution of income \n",
"deviates from a equal distribution (diagonal black line).  \n",
"While in 1969 the poorest quintile of the U.S. accounted for  \n",
"24% of the income, until 2019 the value decreased to 18%. \n",
"In the meantime the ")),hjust=0)+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
View(df)
1-0.4812
1-0.5696
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0,y=1,label="Increasing inequalities"),size=10,hjust=0)+
geom_text(aes(x=0,y=0.8,label=paste0("The Lorenz curve shows how much the distribution of income \n",
"deviates from a equal distribution (diagonal black line).  \n",
"While in 1969 the poorer half of the U.S. accounted for  \n",
"24% of the income, until 2019 the value decreased to 18%. \n",
"In the meantime the richest quintile increased their income \n",
"share from 43% to 52%.")),hjust=0)+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0,y=1,label="Increasing inequalities"),size=10,hjust=0)+
geom_text(aes(x=0,y=0.8,label=paste0("The Lorenz curve shows how much the distribution of income \n",
"deviates from a equal distribution (diagonal black line).  \n",
"While in 1969 the poorer half of the U.S. accounted for  \n",
"24% of the income, until 2019 the value decreased to 18%. \n",
"In the meantime the richest quintile increased their \n",
"income share from 43% to 52%.")),hjust=0)+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0,y=1,label="Increasing inequalities"),size=10,hjust=0)+
geom_text(aes(x=0,y=0.75,label=paste0("The Lorenz curve shows how much the distribution of income \n",
"deviates from a equal distribution (diagonal black line).  \n",
"While in 1969 the poorer half of the U.S. accounted for 24%  \n",
"of the income, until 2019 the value decreased to 18%. \n",
"In the meantime the richest quintile increased their \n",
"income share from 43% to 52%.")),hjust=0)+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0,y=1,label="Increasing inequalities"),size=10,hjust=0,col="darkblue")+
geom_text(aes(x=0,y=0.75,label=paste0("The Lorenz curve shows how much the distribution of income \n",
"deviates from a equal distribution (diagonal black line).  \n",
"While in 1969 the poorer half of the U.S. accounted for 24%  \n",
"of the income, until 2019 the value decreased to 18%. \n",
"In the meantime the richest quintile increased their \n",
"income share from 43% to 52%.")),hjust=0,col="darkblue")+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0,y=1,label="Increasing inequalities"),size=10,hjust=0,col="black")+
geom_text(aes(x=0,y=0.75,label=paste0("The Lorenz curve shows how much the distribution of income \n",
"deviates from a equal distribution (diagonal black line).  \n",
"While in 1969 the poorer half of the U.S. accounted for 24%  \n",
"of the income, until 2019 the value decreased to 18%. \n",
"In the meantime the richest quintile increased their \n",
"income share from 43% to 52%.")),hjust=0,col="black")+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0,y=1,label="Increasing inequalities"),size=8,hjust=0,col="black")+
geom_text(aes(x=0,y=0.75,label=paste0("The Lorenz curve shows how much the distribution of income \n",
"deviates from a equal distribution (diagonal black line).  \n",
"While in 1969 the poorer half of the U.S. accounted for 24%  \n",
"of the income, until 2019 the value decreased to 18%. \n",
"In the meantime the richest quintile increased their \n",
"income share from 43% to 52%.")),hjust=0,col="black")+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0,y=1,label="Increasing inequalities"),size=8,hjust=0,col="black")+
geom_text(aes(x=0,y=0.75,label=paste0("The Lorenz curve shows how much the distribution of income \n",
"deviates from a equal distribution (diagonal black line).  \n",
"While in 1969 the poorer half of the U.S. accounted for 24%  \n",
"of the income, until 2019 the value decreased step by  \n",
"step to 18%. In the meantime the richest quintile  \n",
"increased their income share from 43% to 52%.")),hjust=0,col="black")+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
library(ggtext)
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0,y=1,label="Increasing inequalities"),size=8,hjust=0,col="black")+
geom_text(aes(x=0,y=0.75,label=paste0("The Lorenz curve shows how much the distribution of income \n",
"deviates from a equal distribution (diagonal black line).  \n",
"While in <span style = 'color:red;'> 1969 <\span> the poorer half of the U.S. accounted for 24%  \n",
"of the income, until 2019 the value decreased step by  \n",
"step to 18%. In the meantime the richest quintile  \n",
"increased their income share from 43% to 52%.")),hjust=0,col="black")+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion")+
geom_text(aes(x=0,y=1,label="Increasing inequalities"),size=8,hjust=0,col="black")+
geom_text(aes(x=0,y=0.75,label=paste0("The Lorenz curve shows how much the distribution of income \n",
"deviates from a equal distribution (diagonal black line).  \n",
"While in <span style = 'color:red;'> 1969 <\span> the poorer half of the U.S. accounted for 24%  \n",
"of the income, until 2019 the value decreased step by  \n",
"step to 18%. In the meantime the richest quintile  \n",
"increased their income share from 43% to 52%.")),hjust=0,col="black")+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
library(ggtext)
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion",
title="Increasing inequalities",
subtitle=paste0("The Lorenz curve shows how much the distribution of income \n",
"deviates from a equal distribution (diagonal black line).  \n",
"While in <span style = 'color:red;'> 1969 <\span> the poorer half of the U.S. accounted for 24%  \n",
"of the income, until 2019 the value decreased step by  \n",
"step to 18%. In the meantime the richest quintile  \n",
"increased their income share from 43% to 52%."))+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion",
title="Increasing inequalities",
subtitle=paste0("The Lorenz curve shows how much the distribution of income \n",
"deviates from a equal distribution (diagonal black line).  \n",
"While in <span style = 'color:red;'> 1969 <\span> the poorer half of the U.S. accounted for 24%  \n",
"of the income, until 2019 the value decreased step by  \n",
"step to 18%. In the meantime the richest quintile  \n",
"increased their income share from 43% to 52%."))+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion",
title="Increasing inequalities",
subtitle=paste0("The Lorenz curve shows how much the distribution of income \n",
"deviates from a equal distribution (diagonal black line). \n",
"While in 1969 the poorer half of the U.S. accounted for 24%  \n",
"of the income, until 2019 the value decreased step by  \n",
"step to 18%. In the meantime the richest quintile  \n",
"increased their income share from 43% to 52%."))+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank())
df %>%
ggplot(aes(x=pop_quintile,y=income_prop,col=year,group=year))+
geom_line(size=1)+
geom_text(aes(x=0.6,y=0.4,label="1969"),col="#0072B2")+
geom_text(aes(x=0.7,y=0.3,label="2019"),col="#E69F00")+
geom_segment(aes(x=0,y=0,xend=1,yend=1),col="black")+
scale_color_gradient(low="#0072B2",high="#E69F00")+
scale_y_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
scale_x_continuous(breaks=c(0,0.2,0.4,0.6,0.8,1),labels=scales::percent)+
labs(x="Population proportion",y="Income proportion",
title="Increasing inequalities",
subtitle=paste0("The Lorenz curve shows how much the distribution of income \n",
"deviates from a equal distribution (diagonal black line). \n",
"While in 1969 the poorer half of the U.S. accounted for 24%  \n",
"of the income, until 2019 the value decreased step by  \n",
"step to 18%. In the meantime the richest quintile  \n",
"increased their income share from 43% to 52%."))+
theme_light()+
theme(legend.position = "none",
panel.grid = element_blank(),
plot.title = element_text(vjust = -10),
plot.subtitle = element_text(vjust = -15))
