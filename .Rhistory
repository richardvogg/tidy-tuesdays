kenya_hex +
inset_element(kenya,left=0.7,bottom = 0.8,right=0.9,top=1)
kenya_hex +
inset_element(kenya,left=0.8,bottom = 0.8,right=1,top=1)+
inset_element(kenya_in_africa_map,left=0.6,bottom = 0.8, right = 0.79,top=1)
kenya_in_africa_map <- World %>%
filter(continent == "Africa") %>%
mutate(kenya = ifelse(name=="Kenya","Y","N")) %>%
ggplot()+geom_sf(aes(fill=kenya),size=NA)+
scale_fill_manual(values=c("grey80","blue"),guide=FALSE)+
theme_void()
kenya_hex +
inset_element(kenya,left=0.8,bottom = 0.8,right=1,top=1)+
inset_element(kenya_in_africa_map,left=0.6,bottom = 0.8, right = 0.79,top=1)
kenya_in_africa_map <- World %>%
filter(continent == "Africa") %>%
mutate(kenya = ifelse(name=="Kenya","Y","N")) %>%
ggplot()+geom_sf(aes(fill=kenya),size=NA)+
scale_fill_manual(values=c("grey80","blue"),guide=FALSE)+
theme_void()+
theme(panel.background = element_rect(colour="black"))
kenya_hex +
inset_element(kenya,left=0.8,bottom = 0.8,right=1,top=1)+
inset_element(kenya_in_africa_map,left=0.6,bottom = 0.8, right = 0.79,top=1)
kenya_hex +
inset_element(kenya,left=0.8,bottom = 0.8,right=1,top=0.95)+
inset_element(kenya_in_africa_map,left=0.6,bottom = 0.8, right = 0.79,top=0.95)
kenya_hex +
inset_element(kenya,left=0.8,bottom = 0.8,right=0.99,top=0.99)+
inset_element(kenya_in_africa_map,left=0.6,bottom = 0.8, right = 0.79,top=0.99)
kenya_hex +
inset_element(kenya,left=0.8,bottom = 0.8,right=0.99,top=0.99)+
inset_element(kenya_in_africa_map,left=0.6,bottom = 0.8, right = 0.79,top=0.95)
inset_map <- kenya + kenya_in_africa_map
inset_map
kenya_hex +
inset_element(kenya,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex <- kenya_hex_shapes %>%
left_join(households,by=c("County_for_join"="County")) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=NumberOfHouseholds))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and number of households")+
theme_void()
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
inset_map <- kenya_in_africa_map + kenya
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex <- kenya_hex_shapes %>%
left_join(households,by=c("County_for_join"="County")) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=NumberOfHouseholds))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and number of households")+
theme_void()+
theme(legend.position = c(0,0))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex <- kenya_hex_shapes %>%
left_join(households,by=c("County_for_join"="County")) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=NumberOfHouseholds))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and number of households", fill = "Households")+
theme_void()+
theme(legend.position = c(0.2,0.2))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex <- kenya_hex_shapes %>%
left_join(households,by=c("County_for_join"="County")) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=NumberOfHouseholds))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and number of households", fill = "Households")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
View(gender)
View(crops)
gender <- tuesdata$gender
gender
gender <- tuesdata$gender %>%
mutate(County= County %>% toupper() %>% trimws())
gender
gender <- tuesdata$gender %>%
mutate(County= County %>% toupper())
View(gender)
gender <- tuesdata$gender %>%
mutate(County= County %>% toupper(),
perc_female = Female / (Female + Male))
View(gender)
rKenyaCensus::V3_T2.2
ages <- rKenyaCensus::V3_T2.3
View(ages)
ages <- rKenyaCensus::V4_T2.37
births <- rKenyaCensus::V4_T2.37
View(births)
?rKenyaCensus::V4_T2.37
View(births)
kenya <- kenya_shapes %>%
#left_join(households,by=c("County_for_join"="County")) %>%
inner_join(births,by="County") %>% View()
View(kenya_shapes)
kenya_shapes <- rKenyaCensus::KenyaCounties_SHP %>%
st_as_sf() %>%
st_simplify(dTolerance=500) %>% # makes the shapefile lighter and much faster to load
mutate(County_for_join=str_replace(County,"/","-"))
kenya <- kenya_shapes %>%
left_join(households,by="County") %>%
ggplot()+geom_sf(aes(fill=NumberOfHouseholds),col=NA)+
scale_fill_gradient(low="grey80",high="darkorange",guide=FALSE)+
theme_void()+
theme(panel.background = element_rect(colour="black"))
#Use patchwork to put maps together
inset_map <- kenya_in_africa_map + kenya
inset_map
kenya <- kenya_shapes %>%
left_join(households,by=c("County_for_join"="County")) %>%
ggplot()+geom_sf(aes(fill=NumberOfHouseholds),col=NA)+
scale_fill_gradient(low="grey80",high="darkorange",guide=FALSE)+
theme_void()+
theme(panel.background = element_rect(colour="black"))
inset_map
kenya_shapes <- rKenyaCensus::KenyaCounties_SHP %>%
st_as_sf() %>%
st_simplify(dTolerance=500) %>% # makes the shapefile lighter and much faster to load
mutate(County_for_join=str_replace(County,"/","-"))
kenya <- kenya_shapes %>%
left_join(households,by=c("County_for_join"="County")) %>%
ggplot()+geom_sf(aes(fill=NumberOfHouseholds),col=NA)+
scale_fill_gradient(low="grey80",high="darkorange",guide=FALSE)+
theme_void()+
theme(panel.background = element_rect(colour="black"))
#Use patchwork to put maps together
inset_map <- kenya_in_africa_map + kenya
inset_map
View(kenya_shapes)
View(births)
kenya <- kenya_shapes %>%
left_join(households,by=c("County_for_join"="County")) %>%
ggplot()+geom_sf(aes(fill=NumberOfHouseholds),col=NA)+
scale_fill_gradient(low="grey80",high="darkorange",guide=FALSE)+
geom_sf_text(aes(label=County))+
theme_void()+
theme(panel.background = element_rect(colour="black"))
kenya
kenya <- kenya_shapes %>%
left_join(households,by=c("County_for_join"="County")) %>% View()
kenya <- kenya_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>% View()
kenya_shapes <- rKenyaCensus::KenyaCounties_SHP %>%
st_as_sf() %>%
st_simplify(dTolerance=500) %>% # makes the shapefile lighter and much faster to load
mutate(County_for_join=str_replace(County,"/","-") %>%
str_replace(County,"HOMA BAY","HOMABAY"))
kenya_shapes <- rKenyaCensus::KenyaCounties_SHP %>%
st_as_sf() %>%
st_simplify(dTolerance=500) %>% # makes the shapefile lighter and much faster to load
mutate(County_for_join=str_replace(County,"/","-") %>%
str_replace("HOMA BAY","HOMABAY"))
kenya <- kenya_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>% View()
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility),col=NA)+
scale_fill_gradient(low="grey80",high="darkorange",guide=FALSE)+
geom_sf_text(aes(label=County))+
theme_void()+
theme(panel.background = element_rect(colour="black"))
kenya <- kenya_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility),col=NA)+
scale_fill_gradient(low="grey80",high="darkorange",guide=FALSE)+
geom_sf_text(aes(label=County))+
theme_void()+
theme(panel.background = element_rect(colour="black"))
kenya
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and number of households", fill = "Households")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>% View()
kenya_hex_shapes
kenya_hex <- kenya_hex_shapes %>% View()
new_cells_hex <- calculate_grid(shape = kenya_shapes, grid_type = "hexagonal", seed = 5)
kenya_hex_shapes <- assign_polygons(kenya_shapes, new_cells_hex)
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and number of households", fill = "Households")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
#Use patchwork to put maps together
inset_map <- kenya_in_africa_map + kenya
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya <- kenya_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility),col=NA)+
scale_fill_gradient(low="grey80",high="darkorange",guide=FALSE)+
theme_void()+
theme(panel.background = element_rect(colour="black"))
#Use patchwork to put maps together
inset_map <- kenya_in_africa_map + kenya
new_cells_hex <- calculate_grid(shape = kenya_shapes, grid_type = "hexagonal", seed = 5)
kenya_hex_shapes <- assign_polygons(kenya_shapes, new_cells_hex)
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and number of households", fill = "Households")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and births in Health Facilities", fill = "% Births in \nHealth Facilities")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and births in Health Facilities",
subtitle="Counting births in the 12 months preceeding the census 2019",
fill = "% Births in \nHealth Facilities")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility,size=Total))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and births in Health Facilities",
subtitle="Counting births in the 12 months preceeding the census 2019",
caption="Data: github.com/Shelmith-Kariuki/rKenyaCensus"
fill = "% Births in \nHealth Facilities")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility,size=Total))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and births in Health Facilities",
subtitle="Counting births in the 12 months preceeding the census 2019",
caption="Data: github.com/Shelmith-Kariuki/rKenyaCensus",
fill = "% Births in \nHealth Facilities")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>% View()
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility,size=100000*Total/Population))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and births in Health Facilities",
subtitle="Counting births in the 12 months preceeding the census 2019",
caption="Data: github.com/Shelmith-Kariuki/rKenyaCensus",
fill = "% Births in \nHealth Facilities")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>% str()
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(Population=as.numeric(Population),
Births_per_100k = 100000*Total/Population) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility,size=100000*Total/Population))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and births in Health Facilities",
subtitle="Counting births in the 12 months preceeding the census 2019",
caption="Data: github.com/Shelmith-Kariuki/rKenyaCensus",
fill = "% Births in \nHealth Facilities")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(Population=as.numeric(Population),
Births_per_100k = 100000*Total/Population) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility,size=Population*Total/100000))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and births in Health Facilities",
subtitle="Counting births in the 12 months preceeding the census 2019",
caption="Data: github.com/Shelmith-Kariuki/rKenyaCensus",
fill = "% Births in \nHealth Facilities")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(Population=as.numeric(Population),
Births_per_100k = 100000*Total/Population) %>% View()
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(Population=as.numeric(as.character(Population)),
Births_per_100k = 100000*Total/Population) %>% View()
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(Population=as.numeric(as.character(Population)),
Births_per_100k = 100000*Total/Population) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility,size=Population*Total/100000))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and births in Health Facilities",
subtitle="Counting births in the 12 months preceeding the census 2019",
caption="Data: github.com/Shelmith-Kariuki/rKenyaCensus",
fill = "% Births in \nHealth Facilities")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(Population=as.numeric(as.character(Population)),
Births_per_100k = Total/(Population/100000)) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility,size=Births_per_100k))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and births in Health Facilities",
subtitle="Counting births in the 12 months preceeding the census 2019",
caption="Data: github.com/Shelmith-Kariuki/rKenyaCensus",
fill = "% Births in \nHealth Facilities")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(Population=as.numeric(as.character(Population)),
Births_per_100k = Total/(Population/100000)) %>% View()
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(Population=as.numeric(as.character(Population)),
Births_per_100k = 100000*Total/Population) %>% View()
4400000/100000
135000/44
pmax(100,Inf)
pmin(100,Inf)
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(Population=as.numeric(as.character(Population)),
Births_per_100k = 100000*Total/Population,
Births_per_100k = ifelse(is.infinite(Births_per_100k),3000,Births_per_100k)) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility,size=Births_per_100k))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and births in Health Facilities",
subtitle="Counting births in the 12 months preceeding the census 2019",
caption="Data: github.com/Shelmith-Kariuki/rKenyaCensus",
fill = "% Births in \nHealth Facilities")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(Population=as.numeric(as.character(Population))) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and births in Health Facilities",
subtitle="Counting births in the 12 months preceeding the census 2019",
caption="Data: github.com/Shelmith-Kariuki/rKenyaCensus",
fill = "% Births in \nHealth Facilities")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(Population=as.numeric(as.character(Population))) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility,size=Population))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and births in Health Facilities",
subtitle="Counting births in the 12 months preceeding the census 2019",
caption="Data: github.com/Shelmith-Kariuki/rKenyaCensus",
fill = "% Births in \nHealth Facilities")+
theme_void()+
theme(legend.position = c(0.2,0.15))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(Population=as.numeric(as.character(Population))) %>% View()
#Add fonts from google
sysfonts::font_add_google(name = "Fresca","Fresca")
showtext::showtext_auto()
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and births in Health Facilities",
subtitle="Counting births in the 12 months preceeding the census 2019",
caption="Data: github.com/Shelmith-Kariuki/rKenyaCensus",
fill = "% Births in \nHealth Facilities")+
theme_void()+
theme(legend.position = c(0.2,0.15),
plot.title = element_text(size=20,family="Fresca"),
plot.subtitle = element_text(size=16,family = "Fresca"))
kenya_hex <- kenya_hex_shapes %>%
left_join(births,by=c("County_for_join"="County")) %>%
mutate(Population=as.numeric(as.character(Population))) %>%
mutate(County=County %>% str_replace("/","/\n") %>%
str_replace(" ","\n") %>%
str_replace("-","-\n")) %>%
ggplot()+geom_sf(aes(fill=Percent_in_HealthFacility))+
geom_sf_text(aes(label=County),size=2)+
scale_fill_gradient(low="grey80",high="darkorange")+
labs(title="Kenya's counties and births in Health Facilities",
subtitle="Counting births in the 12 months preceeding the census 2019",
caption="Data: github.com/Shelmith-Kariuki/rKenyaCensus",
fill = "% Births in \nHealth Facilities")+
theme_void()+
theme(legend.position = c(0.2,0.15),
plot.title = element_text(size=20,family="Fresca"),
plot.subtitle = element_text(size=16,family = "Fresca"))
kenya_hex +
inset_element(inset_map,left=0.6,bottom = 0.8,right=0.99,top=0.99)
